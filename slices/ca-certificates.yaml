package: ca-certificates

slices:
  bins:
    essentials:
      - bash_bins
      - sed_bins
      - find_bins
      - debianutils_bins
      - openssl_bins
    contents:
      /usr/sbin/update-ca-certificates:

  data:
    contents:
      /etc/ssl/certs/ca-certificates.crt: {text: FIXME, mutable: true}
      /usr/share/ca-certificates/mozilla/: {until: mutate}
      /usr/share/ca-certificates/mozilla/*: {until: mutate}
    mutate: |
      certs_dir = "/usr/share/ca-certificates/mozilla/"
      certs = [
        content.read(certs_dir + path) for path in content.list(certs_dir)
      ]
      content.write("/etc/ssl/certs/ca-certificates.crt", "".join(certs))
